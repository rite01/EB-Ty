{"version":3,"sources":["../../src/helpers/Helper.ts"],"sourcesContent":["import jwt from 'jsonwebtoken';\nimport dotenv from 'dotenv';\nimport bcrypt from 'bcrypt';\n\ndotenv.config();\n\nexport const GenerateToken = (data: any): string => {\n  const token = jwt.sign(data, process.env.JWT_TOKEN as string);\n  return token;\n};\n\nexport const GenerateRefreshToken = (data: any): string => {\n  const token = jwt.sign(data, process.env.JWT_REFRESH_TOKEN as string, { expiresIn: '1d' });\n\n  return token;\n};\n\nexport const PasswordHashing = async (password: string): Promise<string> => {\n  const result = await bcrypt.hash(password, 10);\n  return result;\n};\n\nexport const PasswordCompare = async (password: string, passwordHash: string): Promise<boolean> => {\n  const matched = await bcrypt.compare(password, passwordHash);\n\n  return matched;\n};\n\nexport const ExtractToken = (token: string): any | null => {\n  const secretKey: string = process.env.JWT_TOKEN as string;\n\n  let resData: any;\n\n  const res:any = jwt.verify(token, secretKey, (err, decoded) => {\n    if (err) {\n      resData = null;\n    } else {\n      resData = decoded;\n    }\n    return res;\n  });\n\n  if (resData) {\n    const result: any = <any>(resData);\n    return result;\n  }\n  return null;\n};\n"],"names":["GenerateToken","GenerateRefreshToken","PasswordHashing","PasswordCompare","ExtractToken","dotenv","config","data","token","jwt","sign","process","env","JWT_TOKEN","JWT_REFRESH_TOKEN","expiresIn","password","result","bcrypt","hash","passwordHash","matched","compare","secretKey","resData","res","verify","err","decoded"],"mappings":"AAAA;;;;;;;;;;;IAMaA,aAAa,MAAbA;IAKAC,oBAAoB,MAApBA;IAMAC,eAAe,MAAfA;IAKAC,eAAe,MAAfA;IAMAC,YAAY,MAAZA;;qDA5BG;+CACG;+CACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEnBC,eAAM,CAACC,MAAM;AAEN,MAAMN,gBAAgB,CAACO,OAAsB;IAClD,MAAMC,QAAQC,qBAAG,CAACC,IAAI,CAACH,MAAMI,QAAQC,GAAG,CAACC,SAAS;IAClD,OAAOL;AACT;AAEO,MAAMP,uBAAuB,CAACM,OAAsB;IACzD,MAAMC,QAAQC,qBAAG,CAACC,IAAI,CAACH,MAAMI,QAAQC,GAAG,CAACE,iBAAiB,EAAY;QAAEC,WAAW;IAAK;IAExF,OAAOP;AACT;AAEO,MAAMN;eAAkB,kBAAA,UAAOc,UAAsC;QAC1E,MAAMC,SAAS,MAAMC,eAAM,CAACC,IAAI,CAACH,UAAU;QAC3C,OAAOC;IACT;oBAHaf,gBAAyBc;;;;AAK/B,MAAMb;eAAkB,kBAAA,UAAOa,UAAkBI,cAA2C;QACjG,MAAMC,UAAU,MAAMH,eAAM,CAACI,OAAO,CAACN,UAAUI;QAE/C,OAAOC;IACT;oBAJalB,gBAAyBa,UAAkBI;;;;AAMjD,MAAMhB,eAAe,CAACI,QAA8B;IACzD,MAAMe,YAAoBZ,QAAQC,GAAG,CAACC,SAAS;IAE/C,IAAIW;IAEJ,MAAMC,MAAUhB,qBAAG,CAACiB,MAAM,CAAClB,OAAOe,WAAW,CAACI,KAAKC,UAAY;QAC7D,IAAID,KAAK;YACPH,UAAU,IAAI;QAChB,OAAO;YACLA,UAAUI;QACZ,CAAC;QACD,OAAOH;IACT;IAEA,IAAID,SAAS;QACX,MAAMP,SAAoBO;QAC1B,OAAOP;IACT,CAAC;IACD,OAAO,IAAI;AACb"}