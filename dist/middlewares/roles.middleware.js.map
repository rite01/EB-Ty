{"version":3,"sources":["../../src/middlewares/roles.middleware.ts"],"sourcesContent":["import { Request, Response, NextFunction } from 'express';\n\nimport { ForbiddenException } from '../exceptions';\nimport { ErrorMessage } from '../constants';\nimport { UserRoles } from '../constants/enum.constants';\n\nexport const restrictTo = (...roles: UserRoles[]) => (req: Request, _: Response, next: NextFunction): any => {\n  const { role } = req.body;\n  if (!roles.includes(role)) {\n    throw new ForbiddenException(ErrorMessage.PERMISSION_DENIED);\n  }\n  return next();\n};\n"],"names":["restrictTo","roles","req","_","next","role","body","includes","ForbiddenException","ErrorMessage","PERMISSION_DENIED"],"mappings":"AAAA;;;;+BAMaA;;aAAAA;;4BAJsB;2BACN;AAGtB,MAAMA,aAAa,CAAC,GAAGC,QAAuB,CAACC,KAAcC,GAAaC,OAA4B;QAC3G,MAAM,EAAEC,KAAI,EAAE,GAAGH,IAAII,IAAI;QACzB,IAAI,CAACL,MAAMM,QAAQ,CAACF,OAAO;YACzB,MAAM,IAAIG,8BAAkB,CAACC,uBAAY,CAACC,iBAAiB,EAAE;QAC/D,CAAC;QACD,OAAON;IACT"}