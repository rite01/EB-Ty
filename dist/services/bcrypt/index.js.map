{"version":3,"sources":["../../../src/services/bcrypt/index.ts"],"sourcesContent":["/* eslint-disable class-methods-use-this */\nimport { compare, genSalt, hash } from 'bcrypt';\nimport { sign } from 'jsonwebtoken';\nimport { config } from '../../config';\nimport { IUser } from '../../interfaces';\n\nexport class BcryptService {\n  async hashPassword(password: string): Promise<string> {\n    const salt: string = await genSalt(10);\n    const hashedPassword: string = await hash(password, salt);\n    return hashedPassword;\n  }\n\n  async comparePassword(enteredPassword: string, originalPassword: string): Promise<boolean> {\n    const isMatch: boolean = await compare(enteredPassword, originalPassword);\n    return isMatch;\n  }\n\n  public createToken(user: any): any {\n    const dataStoredInToken: any = { id: user.id, role: user?.role?.name };\n    const secretKey: string = config.JWT.JWT_SECRET;\n    const expiresIn: number = 60 * 60;\n\n    return { expiresIn, token: sign(dataStoredInToken, secretKey, { expiresIn }) };\n  }\n}\n\nexport const bcryptService = new BcryptService();\n"],"names":["BcryptService","bcryptService","hashPassword","password","salt","genSalt","hashedPassword","hash","comparePassword","enteredPassword","originalPassword","isMatch","compare","createToken","user","dataStoredInToken","id","role","name","secretKey","config","JWT","JWT_SECRET","expiresIn","token","sign"],"mappings":"AACA;;;;;;;;;;;IAKaA,aAAa,MAAbA;IAqBAC,aAAa,MAAbA;;wBA1B0B;8BAClB;wBACE;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAGhB,IAAA,AAAMD,gBAAN,MAAMA;IACLE,aAAaC,QAAgB;eAAnC,kBAAA,YAAsD;YACpD,MAAMC,OAAe,MAAMC,IAAAA,eAAO,EAAC;YACnC,MAAMC,iBAAyB,MAAMC,IAAAA,YAAI,EAACJ,UAAUC;YACpD,OAAOE;QACT;;IAEME,gBAAgBC,eAAuB,EAAEC,gBAAwB;eAAvE,kBAAA,YAA2F;YACzF,MAAMC,UAAmB,MAAMC,IAAAA,eAAO,EAACH,iBAAiBC;YACxD,OAAOC;QACT;;IAEOE,YAAYC,IAAS,EAAO;YACmBA;QAApD,MAAMC,oBAAyB;YAAEC,IAAIF,KAAKE,EAAE;YAAEC,MAAMH,iBAAAA,kBAAAA,KAAAA,IAAAA,CAAAA,aAAAA,KAAMG,IAAI,cAAVH,wBAAAA,KAAAA,IAAAA,WAAYI,IAAF;QAAO;QACrE,MAAMC,YAAoBC,cAAM,CAACC,GAAG,CAACC,UAAU;QAC/C,MAAMC,YAAoB,KAAK;QAE/B,OAAO;YAAEA;YAAWC,OAAOC,IAAAA,kBAAI,EAACV,mBAAmBI,WAAW;gBAAEI;YAAU;QAAG;IAC/E;AACF;AAEO,MAAMtB,gBAAgB,IAAID"}